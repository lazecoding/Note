# 计算机网络

- 目录
    - [因特网](#因特网)
    - [协议](#协议)  
        - [OSI 参考模型](#OSI-参考模型)
        - [通信处理](#通信处理)
    - [通信方式](#通信方式)
        - [电路交换](#电路交换)
        - [分组交换](#分组交换)
        - [报文交换](#报文交换)
    - [有连接和无连接](#有连接和无连接)
        - [面向有连接型](#面向有连接型)
        - [面向无连接型](#面向无连接型)
        - [区别于通信方式](#区别于通信方式)    


计算机网络是指将地理位置不同的具有独立功能的多台计算机及其外部设备，通过通信线路连接起来，在网络操作系统，网络管理软件及网络通信协议的管理和协调下，实现资源共享和信息传递的计算机系统。

### 因特网

因特网是一个世界范围的计算机网络，即它是一个互联了遍及全世界上亿的接入网络设备的网络。
网络把主机连接起来，而因特网是把多个的网络连接起来，因此因特网是网络的网络，这些网络以一组标准的网络 TCP/IP 协议族相连。

在因特网的术语中，所有的接入设备都被称为`主机`，或`端系统`。主机通过通信链路和分组交换机连接到一起。
通信链路是用于传输数据的物理介质，一台主机向另一个主机发生数据时，发送端将数据分段并添加首部字节，由此产生的信息包被称为`分组`。这些分组通过网络发送到目标主机，在目标主机中被装配成原始数据。
分组交换机从它的一条入通信链路接收分组，并由一条出分组转发该分组。当前因特网中最广泛使用的两种分组交换机是`路由器`和`链路层交换机`。链路层交换机通常用于接入网中，路由器一般用于网络核心。
从发送端到接收端，一个分组经历的一系列通信链路和分组交换机被称为通过该网络的`路径`。

主机通过因特网服务提供商(Internet Service Provider,ISP)接入因特网，ISP 提供各种网络服务，同时为了保证各个主机可以互联，各种 ISP 之间也要可以互联。

主机、分组交换机和其他因特网部件为了通信需要运行一系列`协议`，这些协议控制因特网中信息的接收和发送。TCP（Transmission Control Protocol，传输控制协议）和 IP（Internet Protocol，网际协议）
是因特网中最重要的两个协议，因特网中的主要协议被统称为 TCP/IP 协议。

### 协议

协议就是为了计算机和计算机之间进行网络通信而事先达成的 "约定"。TCP/IP 协议是 TCP、IP、HTTP 等协议的集合。

#### OSI 参考模型

ISO（International Organization for Standardization，国际标准化组织），制定全世界工商业国际标准的国际标准建立机构。它制定了标准化 OSI（（Open System Interconnection Reference Model，开放式系统互联通信参考模型）。

OSI 参考模型：

<div align="left">
    <img src="https://github.com/lazecoding/Note/blob/main/images/network/OSI参考模型.png" width="400px">
</div>

OSI 参考模型将通信协议中必要的功能分成 7 层，每一分层都接收由它下一层所提供的特定服务，并且负责为上一层提供特定服务。上下层之间进行交互时所遵循的约定叫 "接口"，同一层之间的交互所遵循的约定叫 "协议"。

OSI 参考模型各分层作用：

<div align="left">
    <img src="https://github.com/lazecoding/Note/blob/main/images/network/OSI参考模型各分层作用.png" width="800px">
</div>

- 应用层：为应用程序提供服务并规定应用程序中通信相关的细节，包括文件传输、电子邮件、虚拟终端等协议。
- 表示层：将应用处理的信息转换为适合网络传输的格式，或将来自下一次的数据转换成上层能够处理的格式，即它主要负责数据格式的转换。
- 会话层：负责建立和断开通信连接，以及数据的分割等数据传输相关的管理。
- 传输层：负责可靠传输。只在通信双方节点上进行处理，而无需再路由器上处理。
- 网络层：将数据传入到目标地址，即主要负责寻址和路由选择。
- 数据链路层：负责物理层面上的互联、节点之间的通信传输。将 0、1 序列划分为有意义的数据帧传送给对方主机，即负责数据帧的发送和接收。
- 物理层：负责 0、1 比特流与电压的高低、光的闪灭互换。

#### 通信处理

OSI 模型通信处理流程：

<div align="left">
    <img src="https://github.com/lazecoding/Note/blob/main/images/network/OSI通信处理流程.png" width="600px">
</div> 

发送端（主机 A）从第七层至第一层，由上至下按照顺序传输数据，接收端（主机 B）则从第一次至第七层由下至上按照顺序传输数据。
发送端每个分层都会为从上一层接收到的数据追加必要的 "首部" 信息，接收端对接收到的数据进行 "首部" 与 "内容" 的分离，再转发给上一分层，最终还原发送端的数据。

### 通信方式

通过通信链路和分组交换机传输数据有两种基本方法：电路交换和分组交换。

#### 电路交换

电路交换需要建立一条专用的数据通信路径，这条路径上可能包含许多中间节点。进行数据交换前，首先要建立连接，当连接被建立，这条连接使用的通信路径在整个通信过程中将被独占，直到通信结束才会释放资源。

在电路交换中，数据不需要切分传输，发送端和接收端始终霸占着这条通信路径，在数据的传输上是比较高效、实时的，所以电话网络的通信方式采用的是电路交换。

但由于发送端和接收端始终霸占着这条通信路径，即使它们都没有发送任何数据，它们占用的资源也不会被释放。因此，电路交换的资源利用率是比较低的。

#### 分组交换

当前大多数网络中，主机通信是彼此交换报文。分组交换是将大的数据块（报文）分割成小的分组，并添加源地址、目的地址和分组编号等信息，按照一定顺序分别发布。

分组交换，发送端和接收端之间不需要建立连接，即不需要寻找由发送端到接收端的通信路径。发送端只需要将分组发送给路由器，路由器会根据该分组的目标地址将分组转发。

在因特网中，每个端系统具有一个称为 IP 地址的地址。当发送端要向接收端发送一个分组，发送端会在这个分组的首部中存储目标端的 IP 地址。每台路由器都具有一个`转发表`，用于将目标地址（或目标地址的一部分）映射成为输出链路。当某分组到达一台路由器，
路由器会检查该分组的目标地址并搜索起转发表，以发现适当的出链路进行转发。

分组转发不需要建立从发送端到接收端的连接，没有独占资源，大大提高了资源的利用率。

但分组交换的设计思路也带来了一些问题。分组交换机在开始向输出链路传出分组之前，必须接收到整个分组。在接收到整个分组之前，交换机需要将接收到的分组存储到缓存队列，直到将分组转发。但是这就存在分组丢失的问题，当交换机缓存饱和或溢出就会丢弃分组，即`丢包`。
当分组进入缓存队列，如果缓存队列中积压了很多分组，改负责就需要等待前面的分组处理完毕才能被传输，这种时延叫`排队时延`，这也意味着分组交换不具有实时性。

#### 报文交换

此外还有一致通信方式——报文交换。报文交换是分组交换的前身，报文交换以报文作为数据传输单位，携带有源地址和目的地址等信息。


和分组交换相比，报文交换对报文的大小没有限制，需要交换机有足够的缓存空间，由于单个数据包的大小更大，意味着更容易产生丢包和时延。

目前，报文交换基本上都有分组交换取代。

### 有连接和无连接

通过网络传输数据可以大致分为面向有连接传输和面向无连接传输。

<div align="left">
    <img src="https://github.com/lazecoding/Note/blob/main/images/network/面向有连接型和面向无连接型处理模型.png" width="600px">
</div> 

#### 面向有连接型

面向有连接型在发送数据之前，需要在主机和主机之间建立一条连接。面向有连接型的通信必须经历三个阶段：`建立连接->传输数据->断开连接`。面向有连接型必须在通信传输前后，专门进行建立和断开连接，如果主机之间无法通信，就可以避免发送无谓的数据。

#### 面向无连接型

面向无连接型不要求建立连接，发送端可以自由发送数据，不需要考虑接收端是否存在，即使接收端不存在或无接收数据，发送端也会将数据发送出去。

#### 区别于通信方式

面向有连接型和面向无连接型，它们强调通信必须经历过什么样的阶段。面向连接必须经过三个阶段：建立连接->传输数据->断开连接`，而无连接只有一个阶段：`传送数据`。

电路交换和分组交换则是强调在通信时用户对网络资源的占用方式。电路交换是在连接建立后到连接释放前全程占用信道资源，而分组交换则强调在数据传送时是断续占用信道资源（分组在哪一条链路上传送就占用该链路的资源）。

所以，不能说 "电路交换就是面向连接，而分组交换就是无连接"。


